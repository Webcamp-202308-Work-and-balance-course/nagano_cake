<!-- 注文詳細画面 -->
<%= render 'public/homes/public_layouts' %>

<h2>注文詳細</h2>
<div class="row">
  <div class="col-sm-6">
  <h4>注文情報</h4>
    <table class="table">
      <tr>
        <td class="bg-light">注文日</td>
        <td><%= @order.created_at.strftime("%Y-%m-%d") %></td>
      </tr>
      <tr>
        <td class="bg-light">配送先</td>
        <td><%= @order.shopping_postal_code %>
        <%= @order.shopping_address %></br>
        <%= @order.shopping_name %></td>
      </tr>
      <tr>
        <td class="bg-light">支払い方法</td>
        <td><%= @order.payment_method_i18n %></td>
      </tr>
    </table>
  </div>
    
  <div class="col-sm-4">
    <h4>請求情報</h4>
    <table class="table">
      <tr>
        <td class="bg-light">商品合計</td>
         <% product_total = 0 %>
          <% @order.ordered_products.each do |ordered_product| %>
          <% product_total += ordered_product.tax_included %>
          <% end %>
        <td><%= number_with_delimiter(@order.billing_amount - @order.postage) %></td>
      </tr>
      <tr>
        <td class="bg-light">配送料</td>
        <td><%= @order.postage %></td>
      </tr>
      <tr>
        <th class="bg-light">ご請求額</th>
        <th><%= number_with_delimiter(@order.billing_amount) %></th>
      </tr>
    </table>
  </div>
</div>

<div class="row">
  <div class="col-sm-7">
    <h4>注文内容</h4>
    <table class="table">
      <thead class="bg-light">
        <tr>
          <td>商品</td>
          <td>単価（税込）</td>
          <td>個数</td>
          <td>小計</td>
        </tr>
      </thead>
      <tbody>
        <% @order.ordered_products.each do |ordered_product| %>
          <tr>
            <td><%= ordered_product.item.name %></td>
            <td><%= number_with_delimiter((ordered_product.item.excluding_tax * 1.08).floor) %></td>
            <td><%= ordered_product.amount %></td>
            <td><%= number_with_delimiter((ordered_product.item.excluding_tax * 1.08).floor * ordered_product.amount) %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
